---
interface Props {
  text: string;
  speed?: number;
  className?: string;
}

const { text, speed = 100, className = "" } = Astro.props;
const id = `typing-${Math.random().toString(36).substr(2, 9)}`;
---

<span id={id} class={className}>
  <span class="typed-text"></span>
  <span class="cursor">|</span>
</span>

<script define:vars={{ id, text, speed }}>
  const element = document.getElementById(id);
  const typedTextSpan = element.querySelector('.typed-text');
  const cursorSpan = element.querySelector('.cursor');

  let i = 0;

  function type() {
    if (i < text.length) {
      typedTextSpan.textContent += text.charAt(i);
      i++;
      setTimeout(type, speed);
    }
  }

  // Start typing after a short delay
  setTimeout(() => {
    type();
  }, 500);
</script>

<style>
  .cursor {
    display: inline-block;
    animation: blink 1s infinite;
    margin-left: 2px;
  }

  @keyframes blink {
    0%, 49% {
      opacity: 1;
    }
    50%, 100% {
      opacity: 0;
    }
  }
</style>
